<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Storage - JavaScript Learning</title>
    <style>
        :root {
            --primary-bg: #f0f2f5;
            --text-color: #2c3e50;
            --card-bg: #ffffff;
            --hover-color: linear-gradient(145deg, #4ECDC4, #6BE5D9);
            --hover-shadow: rgba(78, 205, 196, 0.3);
            --code-bg: #f8f8f8;
            --code-border: #e0e0e0;
        }

        .dark-theme {
            --primary-bg: #1a1a1a;
            --text-color: #ffffff;
            --card-bg: #2d2d2d;
            --hover-color: linear-gradient(145deg, #00B894, #00CEC9);
            --hover-shadow: rgba(0, 184, 148, 0.3);
            --code-bg: #2d2d2d;
            --code-border: #444;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            transition: all 0.3s ease;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            position: relative;
            color: var(--text-color);
            text-align: center;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--hover-color);
            border-radius: 2px;
        }

        h2 {
            font-size: 1.8rem;
            margin-top: 30px;
            margin-bottom: 15px;
            color: var(--text-color);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 25px;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        p {
            margin-bottom: 15px;
        }

        ul, ol {
            margin-bottom: 20px;
            padding-left: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background-color: var(--code-bg);
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
            border: 1px solid var(--code-border);
        }

        pre {
            background-color: var(--code-bg);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid var(--code-border);
            margin-bottom: 20px;
        }

        .home-button {
            display: inline-block;
            padding: 10px 20px;
            background: var(--card-bg);
            color: var(--text-color);
            text-decoration: none;
            border-radius: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .home-button:hover {
            background-image: var(--hover-color);
            color: white;
            transform: translateY(-2px);
        }

        .home-button:before {
            content: "‚Üê";
            margin-right: 8px;
        }

        .resources {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--code-border);
        }

        .resources h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .resources ul {
            list-style-type: none;
            padding-left: 0;
        }

        .resources li {
            margin-bottom: 10px;
        }

        .resources a {
            color: #4ECDC4;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .resources a:hover {
            text-decoration: underline;
            color: #2aa198;
        }

        .examples {
            margin-top: 30px;
            background-color: var(--code-bg);
            padding: 20px;
            border-radius: 5px;
            border: 1px solid var(--code-border);
        }

        .examples h3 {
            margin-top: 0;
            margin-bottom: 15px;
        }

        .theme-switch {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            background: var(--card-bg);
            border: none;
            color: var(--text-color);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .theme-switch:hover {
            background-image: var(--hover-color);
            color: white;
            transform: scale(1.05);
        }

        .comparison {
            display: flex;
            margin: 20px 0;
            border: 1px solid var(--code-border);
            border-radius: 5px;
            overflow: hidden;
        }

        .comparison-column {
            flex: 1;
            padding: 15px;
        }

        .comparison-column:first-child {
            background-color: rgba(255, 100, 100, 0.1);
        }

        .comparison-column:last-child {
            background-color: rgba(100, 255, 100, 0.1);
        }

        .dark-theme .comparison-column:first-child {
            background-color: rgba(255, 100, 100, 0.2);
        }

        .dark-theme .comparison-column:last-child {
            background-color: rgba(100, 255, 100, 0.2);
        }

        .comparison h4 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .tip-box {
            background-color: rgba(78, 205, 196, 0.1);
            border-left: 4px solid #4ECDC4;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        .tip-box h4 {
            margin-top: 0;
            color: #4ECDC4;
        }

        .warning-box {
            background-color: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        .warning-box h4 {
            margin-top: 0;
            color: #ffc107;
        }

        .demo-container {
            background-color: var(--code-bg);
            border: 1px solid var(--code-border);
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }

        .demo-container h3 {
            margin-top: 0;
            margin-bottom: 15px;
        }

        .demo-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .demo-button {
            padding: 8px 15px;
            background-color: #4ECDC4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .demo-button:hover {
            background-color: #3bafa6;
            transform: translateY(-2px);
        }

        .demo-output {
            background-color: var(--card-bg);
            border: 1px solid var(--code-border);
            border-radius: 4px;
            padding: 10px;
            min-height: 100px;
            margin-top: 10px;
            font-family: monospace;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            border: 1px solid var(--code-border);
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: var(--code-bg);
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: rgba(0, 0, 0, 0.03);
        }

        .dark-theme tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.03);
        }
    </style>
</head>
<body>
    <a href="../javascript.html" class="home-button">Back to JavaScript Topics</a>
    <button class="theme-switch" onclick="toggleTheme()">Toggle Theme</button>

    <div class="container">
        <h1>Local Storage</h1>
        
        <p>Web Storage API provides mechanisms for storing data in the browser, allowing web applications to save state and data locally. Local Storage is a key-value storage system that persists data even after the browser is closed, making it useful for saving user preferences, application state, and other data that should be available across browser sessions.</p>
        
        <h2>Web Storage Types</h2>
        
        <p>The Web Storage API provides two mechanisms for storing data:</p>
        
        <table>
            <tr>
                <th>Feature</th>
                <th>localStorage</th>
                <th>sessionStorage</th>
            </tr>
            <tr>
                <td>Lifetime</td>
                <td>Persists until explicitly deleted</td>
                <td>Persists only for the duration of the page session</td>
            </tr>
            <tr>
                <td>Scope</td>
                <td>Available across all tabs/windows with the same origin</td>
                <td>Limited to the tab/window that created it</td>
            </tr>
            <tr>
                <td>Storage Limit</td>
                <td>~5MB (varies by browser)</td>
                <td>~5MB (varies by browser)</td>
            </tr>
            <tr>
                <td>Data Type</td>
                <td>Strings only</td>
                <td>Strings only</td>
            </tr>
        </table>
        
        <p>This guide focuses primarily on localStorage, but most methods and concepts apply to sessionStorage as well.</p>
        
        <h2>Basic Operations</h2>
        
        <h3>Storing Data</h3>
        
        <p>Use the <code>setItem()</code> method to store data in localStorage:</p>
        
        <pre><code>// Syntax: localStorage.setItem(key, value)
localStorage.setItem('username', 'john_doe');
localStorage.setItem('isLoggedIn', 'true');
localStorage.setItem('lastLogin', new Date().toString());</code></pre>
        
        <div class="tip-box">
            <h4>Important Note</h4>
            <p>localStorage can only store strings. If you need to store objects or arrays, you must convert them to strings first, typically using JSON.stringify():</p>
            <pre><code>const user = {
  id: 123,
  name: 'John Doe',
  email: 'john@example.com',
  preferences: {
    theme: 'dark',
    notifications: true
  }
};

// Convert object to string before storing
localStorage.setItem('user', JSON.stringify(user));</code></pre>
        </div>
        
        <h3>Retrieving Data</h3>
        
        <p>Use the <code>getItem()</code> method to retrieve data from localStorage:</p>
        
        <pre><code>// Syntax: localStorage.getItem(key)
const username = localStorage.getItem('username');
console.log(username); // 'john_doe'

// If the key doesn't exist, getItem returns null
const age = localStorage.getItem('age');
console.log(age); // null</code></pre>
        
        <p>When retrieving objects or arrays, you need to parse the string back to its original form:</p>
        
        <pre><code>// Retrieve and parse JSON data
const userString = localStorage.getItem('user');
if (userString) {
  const user = JSON.parse(userString);
  console.log(user.name); // 'John Doe'
  console.log(user.preferences.theme); // 'dark'
}</code></pre>
        
        <h3>Removing Data</h3>
        
        <p>Use the <code>removeItem()</code> method to remove a specific item from localStorage:</p>
        
        <pre><code>// Syntax: localStorage.removeItem(key)
localStorage.removeItem('username');</code></pre>
        
        <h3>Clearing All Data</h3>
        
        <p>Use the <code>clear()</code> method to remove all items from localStorage:</p>
        
        <pre><code>// Removes all data stored in localStorage for the domain
localStorage.clear();</code></pre>
        
        <h3>Checking if a Key Exists</h3>
        
        <pre><code>// Check if a key exists in localStorage
if (localStorage.getItem('username') !== null) {
  console.log('Username exists in localStorage');
}

// Alternative approach
if ('username' in localStorage) {
  console.log('Username exists in localStorage');
}</code></pre>
        
        <h3>Getting All Keys</h3>
        
        <p>You can access all keys stored in localStorage using the <code>key()</code> method or by iterating through localStorage:</p>
        
        <pre><code>// Get the number of items in localStorage
const itemCount = localStorage.length;
console.log(`There are ${itemCount} items in localStorage`);

// Get all keys using key() method
for (let i = 0; i < localStorage.length; i++) {
  const key = localStorage.key(i);
  console.log(`Key at index ${i}: ${key}`);
}

// Iterate through all items in localStorage
for (const key in localStorage) {
  if (localStorage.hasOwnProperty(key)) {
    console.log(`${key}: ${localStorage.getItem(key)}`);
  }
}</code></pre>
        
        <h2>Working with Complex Data</h2>
        
        <h3>Storing and Retrieving Objects</h3>
        
        <pre><code>// Storing an object
const product = {
  id: 'p123',
  name: 'Wireless Headphones',
  price: 99.99,
  inStock: true,
  specs: {
    color: 'black',
    batteryLife: '20 hours',
    connectivity: 'Bluetooth 5.0'
  }
};

// Store the object
localStorage.setItem('product', JSON.stringify(product));

// Retrieve and use the object
const storedProduct = JSON.parse(localStorage.getItem('product'));
console.log(storedProduct.name); // 'Wireless Headphones'
console.log(storedProduct.specs.batteryLife); // '20 hours'</code></pre>
        
        <h3>Storing and Retrieving Arrays</h3>
        
        <pre><code>// Storing an array
const todoList = [
  { id: 1, text: 'Learn JavaScript', completed: true },
  { id: 2, text: 'Build a project', completed: false },
  { id: 3, text: 'Deploy to production', completed: false }
];

// Store the array
localStorage.setItem('todos', JSON.stringify(todoList));

// Retrieve and use the array
const storedTodos = JSON.parse(localStorage.getItem('todos'));
console.log(`You have ${storedTodos.length} todos`);

// Filter the array
const incompleteTodos = storedTodos.filter(todo => !todo.completed);
console.log(`${incompleteTodos.length} todos remaining`);</code></pre>
        
        <h3>Updating Stored Objects</h3>
        
        <p>To update a stored object, you need to retrieve it, modify it, and then save it back:</p>
        
        <pre><code>// Retrieve the stored user object
const user = JSON.parse(localStorage.getItem('user')) || {};

// Update properties
user.lastLogin = new Date().toString();
user.loginCount = (user.loginCount || 0) + 1;
user.preferences = {
  ...user.preferences, // Keep existing preferences
  theme: 'light' // Update specific preference
};

// Save the updated object back to localStorage
localStorage.setItem('user', JSON.stringify(user));</code></pre>
        
        <h3>Updating Stored Arrays</h3>
        
        <pre><code>// Retrieve the stored todo list
const todos = JSON.parse(localStorage.getItem('todos')) || [];

// Add a new todo
const newTodo = {
  id: Date.now(), // Use timestamp as a simple unique ID
  text: 'Learn Local Storage',
  completed: false
};
todos.push(newTodo);

// Mark a todo as completed
const todoId = 2;
const todoIndex = todos.findIndex(todo => todo.id === todoId);
if (todoIndex !== -1) {
  todos[todoIndex].completed = true;
}

// Remove a todo
const filteredTodos = todos.filter(todo => todo.id !== 3);

// Save the updated array back to localStorage
localStorage.setItem('todos', JSON.stringify(filteredTodos));</code></pre>
        
        <h2>Best Practices and Patterns</h2>
        
        <h3>Creating a Storage Wrapper</h3>
        
        <p>It's often useful to create a wrapper around localStorage to handle JSON parsing/stringifying and provide a cleaner API:</p>
        
        <pre><code>// Storage utility
const Storage = {
  get(key, defaultValue = null) {
    const value = localStorage.getItem(key);
    if (value === null) return defaultValue;
    
    try {
      return JSON.parse(value);
    } catch (e) {
      return value;
    }
  },
  
  set(key, value) {
    if (typeof value === 'object') {
      localStorage.setItem(key, JSON.stringify(value));
    } else {
      localStorage.setItem(key, value);
    }
  },
  
  remove(key) {
    localStorage.removeItem(key);
  },
  
  clear() {
    localStorage.clear();
  },
  
  has(key) {
    return localStorage.getItem(key) !== null;
  },
  
  keys() {
    return Object.keys(localStorage);
  }
};

// Usage
Storage.set('user', { name: 'John', age: 30 });
const user = Storage.get('user');
console.log(user.name); // 'John'

// With default value
const settings = Storage.get('settings', { theme: 'light', fontSize: 'medium' });
console.log(settings.theme); // 'light' (default value)</code></pre>
        
        <h3>Namespacing</h3>
        
        <p>To avoid key collisions with other scripts, use a namespace prefix for your keys:</p>
        
        <pre><code>// Namespaced storage utility
const AppStorage = {
  prefix: 'myApp_',
  
  get(key, defaultValue = null) {
    const value = localStorage.getItem(this.prefix + key);
    if (value === null) return defaultValue;
    
    try {
      return JSON.parse(value);
    } catch (e) {
      return value;
    }
  },
  
  set(key, value) {
    const valueToStore = typeof value === 'object' ? JSON.stringify(value) : value;
    localStorage.setItem(this.prefix + key, valueToStore);
  },
  
  remove(key) {
    localStorage.removeItem(this.prefix + key);
  },
  
  clearAll() {
    // Only clear items with our prefix
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      if (key.startsWith(this.prefix)) {
        localStorage.removeItem(key);
      }
    }
  }
};

// Usage
AppStorage.set('user', { name: 'John' }); // Stored as 'myApp_user'</code></pre>
        
        <h3>Handling Storage Events</h3>
        
        <p>The <code>storage</code> event fires when localStorage changes in other tabs/windows:</p>
        
        <pre><code>// Listen for changes to localStorage from other tabs/windows
window.addEventListener('storage', (event) => {
  console.log('Storage changed in another tab/window');
  console.log('Key:', event.key);
  console.log('Old value:', event.oldValue);
  console.log('New value:', event.newValue);
  console.log('URL of page that made the change:', event.url);
  
  // Update UI based on the change
  if (event.key === 'theme') {
    updateTheme(event.newValue);
  }
});</code></pre>
        
        <div class="warning-box">
            <h4>Important Note</h4>
            <p>The storage event is only triggered when localStorage is modified from another tab or window. Changes made in the current tab do not trigger this event.</p>
        </div>
        
        <h3>Error Handling</h3>
        
        <p>localStorage operations can fail for several reasons, including storage limits, privacy modes, or disabled storage. Always use try-catch blocks for robust error handling:</p>
        
        <pre><code>function safelyStoreData(key, value) {
  try {
    const valueToStore = typeof value === 'object' ? JSON.stringify(value) : value;
    localStorage.setItem(key, valueToStore);
    return true;
  } catch (error) {
    console.error('Failed to store data in localStorage:', error);
    
    if (error.name === 'QuotaExceededError') {
      alert('Storage quota exceeded. Try clearing some space by removing unused data.');
    } else {
      alert('Unable to save your data. Local storage might be disabled or full.');
    }
    
    return false;
  }
}

function safelyGetData(key, defaultValue = null) {
  try {
    const value = localStorage.getItem(key);
    if (value === null) return defaultValue;
    
    return JSON.parse(value);
  } catch (error) {
    console.error('Failed to retrieve data from localStorage:', error);
    return defaultValue;
  }
}</code></pre>
        
        <h2>Practical Examples</h2>
        
        <h3>Example 1: User Preferences</h3>
        
        <pre><code>// User preferences manager
const UserPreferences = {
  defaults: {
    theme: 'light',
    fontSize: 'medium',
    notifications: true,
    language: 'en'
  },
  
  // Get all preferences
  getAll() {
    try {
      const stored = localStorage.getItem('userPreferences');
      return stored ? { ...this.defaults, ...JSON.parse(stored) } : this.defaults;
    } catch (e) {
      console.error('Error loading preferences:', e);
      return this.defaults;
    }
  },
  
  // Get a specific preference
  get(key) {
    const prefs = this.getAll();
    return prefs[key];
  },
  
  // Set a specific preference
  set(key, value) {
    try {
      const prefs = this.getAll();
      prefs[key] = value;
      localStorage.setItem('userPreferences', JSON.stringify(prefs));
      
      // Dispatch an event so other parts of the app can react
      window.dispatchEvent(new CustomEvent('preferencesChanged', {
        detail: { key, value, preferences: prefs }
      }));
      
      return true;
    } catch (e) {
      console.error('Error saving preference:', e);
      return false;
    }
  },
  
  // Reset all preferences to defaults
  reset() {
    try {
      localStorage.setItem('userPreferences', JSON.stringify(this.defaults));
      
      window.dispatchEvent(new CustomEvent('preferencesChanged', {
        detail: { preferences: this.defaults, reset: true }
      }));
      
      return true;
    } catch (e) {
      console.error('Error resetting preferences:', e);
      return false;
    }
  }
};

// Usage
const prefs = UserPreferences.getAll();
console.log(`Current theme: ${prefs.theme}`);

// Change theme
UserPreferences.set('theme', 'dark');

// Listen for preference changes
window.addEventListener('preferencesChanged', (event) => {
  console.log('Preference changed:', event.detail);
  
  // Update UI based on the changed preference
  if (event.detail.key === 'theme') {
    document.body.className = event.detail.value;
  }
});</code></pre>
        
        <h3>Example 2: Shopping Cart</h3>
        
        <pre><code>// Shopping cart manager
const ShoppingCart = {
  // Get the current cart
  getCart() {
    try {
      return JSON.parse(localStorage.getItem('cart')) || [];
    } catch (e) {
      console.error('Error loading cart:', e);
      return [];
    }
  },
  
  // Save the cart
  saveCart(cart) {
    try {
      localStorage.setItem('cart', JSON.stringify(cart));
      this.updateCartUI();
      return true;
    } catch (e) {
      console.error('Error saving cart:', e);
      return false;
    }
  },
  
  // Add an item to the cart
  addItem(product, quantity = 1) {
    const cart = this.getCart();
    
    // Check if the product is already in the cart
    const existingItem = cart.find(item => item.id === product.id);
    
    if (existingItem) {
      // Update quantity if the product is already in the cart
      existingItem.quantity += quantity;
    } else {
      // Add new item to the cart
      cart.push({
        id: product.id,
        name: product.name,
        price: product.price,
        quantity: quantity,
        addedAt: new Date().toISOString()
      });
    }
    
    return this.saveCart(cart);
  },
  
  // Update item quantity
  updateQuantity(productId, quantity) {
    const cart = this.getCart();
    const item = cart.find(item => item.id === productId);
    
    if (item) {
      if (quantity > 0) {
        item.quantity = quantity;
      } else {
        // Remove item if quantity is 0 or negative
        return this.removeItem(productId);
      }
      
      return this.saveCart(cart);
    }
    
    return false;
  },
  
  // Remove an item from the cart
  removeItem(productId) {
    const cart = this.getCart();
    const updatedCart = cart.filter(item => item.id !== productId);
    
    return this.saveCart(updatedCart);
  },
  
  // Clear the cart
  clearCart() {
    return this.saveCart([]);
  },
  
  // Calculate cart total
  getTotal() {
    const cart = this.getCart();
    return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
  },
  
  // Get number of items in cart
  getItemCount() {
    const cart = this.getCart();
    return cart.reduce((count, item) => count + item.quantity, 0);
  },
  
  // Update the cart UI (example implementation)
  updateCartUI() {
    const cartCount = document.getElementById('cart-count');
    const cartTotal = document.getElementById('cart-total');
    
    if (cartCount) {
      cartCount.textContent = this.getItemCount();
    }
    
    if (cartTotal) {
      cartTotal.textContent = `$${this.getTotal().toFixed(2)}`;
    }
  }
};

// Usage
// Add a product to the cart
ShoppingCart.addItem({
  id: 'prod123',
  name: 'Wireless Headphones',
  price: 99.99
});

// Update quantity
ShoppingCart.updateQuantity('prod123', 2);

// Get cart information
console.log(`Items in cart: ${ShoppingCart.getItemCount()}`);
console.log(`Cart total: $${ShoppingCart.getTotal().toFixed(2)}`);</code></pre>
        
        <h3>Example 3: Form State Persistence</h3>
        
        <pre><code>// Form state manager
const FormPersistence = {
  // Save form data
  saveForm(formId, data) {
    try {
      localStorage.setItem(`form_${formId}`, JSON.stringify({
        data,
        timestamp: new Date().toISOString()
      }));
      return true;
    } catch (e) {
      console.error('Error saving form:', e);
      return false;
    }
  },
  
  // Load form data
  loadForm(formId) {
    try {
      const saved = localStorage.getItem(`form_${formId}`);
      return saved ? JSON.parse(saved) : null;
    } catch (e) {
      console.error('Error loading form:', e);
      return null;
    }
  },
  
  // Clear form data
  clearForm(formId) {
    localStorage.removeItem(`form_${formId}`);
  },
  
  // Auto-save form data
  setupAutoSave(formId, interval = 5000) {
    const form = document.getElementById(formId);
    if (!form) return false;
    
    // Initial load
    this.loadFormIntoDOM(formId);
    
    // Setup auto-save
    const intervalId = setInterval(() => {
      this.saveFormFromDOM(formId);
    }, interval);
    
    // Save on form submission
    form.addEventListener('submit', () => {
      this.clearForm(formId);
      clearInterval(intervalId);
    });
    
    return true;
  },
  
  // Save form data from DOM
  saveFormFromDOM(formId) {
    const form = document.getElementById(formId);
    if (!form) return false;
    
    const formData = {};
    const elements = form.elements;
    
    for (let i = 0; i < elements.length; i++) {
      const element = elements[i];
      
      if (element.name && element.type !== 'submit' && element.type !== 'button') {
        if (element.type === 'checkbox' || element.type === 'radio') {
          formData[element.name] = element.checked;
        } else {
          formData[element.name] = element.value;
        }
      }
    }
    
    return this.saveForm(formId, formData);
  },
  
  // Load form data into DOM
  loadFormIntoDOM(formId) {
    const form = document.getElementById(formId);
    if (!form) return false;
    
    const saved = this.loadForm(formId);
    if (!saved || !saved.data) return false;
    
    const data = saved.data;
    const elements = form.elements;
    
    for (let i = 0; i < elements.length; i++) {
      const element = elements[i];
      
      if (element.name && data[element.name] !== undefined) {
        if (element.type === 'checkbox' || element.type === 'radio') {
          element.checked = data[element.name];
        } else {
          element.value = data[element.name];
        }
      }
    }
    
    return true;
  }
};

// Usage
// Setup auto-save for a form
FormPersistence.setupAutoSave('registration-form');

// Manually save form data
document.getElementById('save-button').addEventListener('click', () => {
  FormPersistence.saveFormFromDOM('registration-form');
  alert('Form progress saved!');
});

// Clear saved form data
document.getElementById('clear-button').addEventListener('click', () => {
  FormPersistence.clearForm('registration-form');
  alert('Saved form data cleared!');
});</code></pre>
        
        <h2>Limitations and Considerations</h2>
        
        <h3>Storage Limits</h3>
        
        <p>localStorage has a storage limit of approximately 5MB per domain, though this varies by browser. When approaching this limit, you should:</p>
        
        <ul>
            <li>Only store essential data</li>
            <li>Implement a cleanup strategy for old or unused data</li>
            <li>Consider alternative storage options for larger data (IndexedDB, WebSQL)</li>
        </ul>
        
        <h3>Security Considerations</h3>
        
        <div class="warning-box">
            <h4>Security Warning</h4>
            <p>localStorage is not secure for sensitive data:</p>
            <ul>
                <li>Data is stored in plaintext and accessible to any JavaScript code running on the same domain</li>
                <li>Vulnerable to XSS attacks</li>
                <li>No built-in expiration mechanism</li>
                <li>No HTTP-only flag (unlike cookies)</li>
            </ul>
            <p>Never store sensitive information like passwords, authentication tokens, or personal data in localStorage.</p>
        </div>
        
        <h3>Performance</h3>
        
        <p>While localStorage operations are generally fast, they are synchronous and can block the main thread. For large data operations, consider:</p>
        
        <ul>
            <li>Breaking operations into smaller chunks</li>
            <li>Using web workers for complex operations</li>
            <li>Using IndexedDB for larger datasets (it's asynchronous)</li>
        </ul>
        
        <h3>Browser Compatibility</h3>
        
        <p>localStorage is supported in all modern browsers, but may be disabled in:</p>
        
        <ul>
            <li>Private/incognito browsing modes</li>
            <li>Browsers with strict privacy settings</li>
            <li>Browsers with storage disabled by the user</li>
        </ul>
        
        <p>Always implement fallbacks and error handling for cases where localStorage is unavailable.</p>
        
        <div class="resources">
            <h3>Additional Resources</h3>
            <ul>
                <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank">MDN: Window.localStorage</a></li>
                <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API" target="_blank">MDN: Web Storage API</a></li>
                <li><a href="https://javascript.info/localstorage" target="_blank">JavaScript.info: LocalStorage, sessionStorage</a></li>
                <li><a href="https://web.dev/storage-for-the-web/" target="_blank">web.dev: Storage for the Web</a></li>
                <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API" target="_blank">MDN: IndexedDB API (for larger storage needs)</a></li>
            </ul>
        </div>
    </div>

    <script>
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
        }
        
        // Demo functionality for localStorage
        document.addEventListener('DOMContentLoaded', function() {
            // Add demo functionality if needed
        });
    </script>
</body>
</html>