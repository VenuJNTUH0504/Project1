<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Optimization - JavaScript Learning</title>
    <style>
        :root {
            --primary-bg: #f0f2f5;
            --text-color: #2c3e50;
            --card-bg: #ffffff;
            --hover-color: linear-gradient(145deg, #4ECDC4, #6BE5D9);
            --hover-shadow: rgba(78, 205, 196, 0.3);
            --code-bg: #f8f8f8;
            --code-border: #e0e0e0;
        }

        .dark-theme {
            --primary-bg: #1a1a1a;
            --text-color: #ffffff;
            --card-bg: #2d2d2d;
            --hover-color: linear-gradient(145deg, #00B894, #00CEC9);
            --hover-shadow: rgba(0, 184, 148, 0.3);
            --code-bg: #2d2d2d;
            --code-border: #444;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            transition: all 0.3s ease;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            position: relative;
            color: var(--text-color);
            text-align: center;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--hover-color);
            border-radius: 2px;
        }

        h2 {
            font-size: 1.8rem;
            margin-top: 30px;
            margin-bottom: 15px;
            color: var(--text-color);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 25px;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        p {
            margin-bottom: 15px;
        }

        ul, ol {
            margin-bottom: 20px;
            padding-left: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background-color: var(--code-bg);
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
            border: 1px solid var(--code-border);
        }

        pre {
            background-color: var(--code-bg);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid var(--code-border);
            margin-bottom: 20px;
        }

        .home-button {
            display: inline-block;
            padding: 10px 20px;
            background: var(--card-bg);
            color: var(--text-color);
            text-decoration: none;
            border-radius: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .home-button:hover {
            background-image: var(--hover-color);
            color: white;
            transform: translateY(-2px);
        }

        .home-button:before {
            content: "‚Üê";
            margin-right: 8px;
        }

        .resources {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--code-border);
        }

        .resources h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .resources ul {
            list-style-type: none;
            padding-left: 0;
        }

        .resources li {
            margin-bottom: 10px;
        }

        .resources a {
            color: #4ECDC4;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .resources a:hover {
            text-decoration: underline;
            color: #2aa198;
        }

        .examples {
            margin-top: 30px;
            background-color: var(--code-bg);
            padding: 20px;
            border-radius: 5px;
            border: 1px solid var(--code-border);
        }

        .examples h3 {
            margin-top: 0;
            margin-bottom: 15px;
        }

        .theme-switch {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            background: var(--card-bg);
            border: none;
            color: var(--text-color);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .theme-switch:hover {
            background-image: var(--hover-color);
            color: white;
            transform: scale(1.05);
        }

        .comparison {
            display: flex;
            margin: 20px 0;
            border: 1px solid var(--code-border);
            border-radius: 5px;
            overflow: hidden;
        }

        .comparison-column {
            flex: 1;
            padding: 15px;
        }

        .comparison-column:first-child {
            background-color: #ffdddd;
            color: #333;
        }

        .comparison-column:last-child {
            background-color: #ddffdd;
            color: #333;
        }

        .comparison h4 {
            text-align: center;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .dark-theme .comparison-column:first-child {
            background-color: #5a3434;
            color: #fff;
        }

        .dark-theme .comparison-column:last-child {
            background-color: #345a34;
            color: #fff;
        }

        .performance-tip {
            background-color: rgba(78, 205, 196, 0.1);
            border-left: 4px solid #4ECDC4;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        .performance-tip h4 {
            margin-top: 0;
            color: #4ECDC4;
        }
    </style>
</head>
<body>
    <a href="../javascript.html" class="home-button">Back to JavaScript Topics</a>
    <button class="theme-switch" onclick="toggleTheme()">Toggle Theme</button>

    <div class="container">
        <h1>Performance Optimization</h1>
        
        <p>JavaScript performance optimization is the process of making your code run faster and more efficiently. This is crucial for creating responsive web applications that provide a good user experience, especially on mobile devices or when handling large amounts of data.</p>
        
        <h2>Understanding JavaScript Performance</h2>
        
        <h3>The JavaScript Engine</h3>
        <p>Modern JavaScript engines (like V8 in Chrome, SpiderMonkey in Firefox) use Just-In-Time (JIT) compilation to convert JavaScript into optimized machine code. Understanding how these engines work can help you write more performant code.</p>
        
        <h3>Key Performance Metrics</h3>
        <ul>
            <li><strong>Load Time</strong>: How long it takes for your JavaScript to download and parse</li>
            <li><strong>Execution Time</strong>: How long your code takes to run</li>
            <li><strong>Memory Usage</strong>: How much memory your application consumes</li>
            <li><strong>First Contentful Paint (FCP)</strong>: When the first content appears on screen</li>
            <li><strong>Time to Interactive (TTI)</strong>: When the page becomes fully interactive</li>
            <li><strong>First Input Delay (FID)</strong>: How responsive the page is to user interactions</li>
        </ul>
        
        <h2>Code Optimization Techniques</h2>
        
        <h3>1. Efficient Data Structures and Algorithms</h3>
        <p>Choosing the right data structure and algorithm for your specific use case can dramatically improve performance.</p>
        
        <div class="comparison">
            <div class="comparison-column">
                <h4>Inefficient</h4>
                <pre><code>// O(n) lookup time
const array = [1, 2, 3, 4, 5];
function findItem(item) {
  for (let i = 0; i < array.length; i++) {
    if (array[i] === item) {
      return true;
    }
  }
  return false;
}</code></pre>
            </div>
            <div class="comparison-column">
                <h4>Efficient</h4>
                <pre><code>// O(1) lookup time
const set = new Set([1, 2, 3, 4, 5]);
function findItem(item) {
  return set.has(item);
}</code></pre>
            </div>
        </div>
        
        <h3>2. Optimizing Loops</h3>
        <p>Loops are often performance bottlenecks in JavaScript applications.</p>
        
        <div class="comparison">
            <div class="comparison-column">
                <h4>Inefficient</h4>
                <pre><code>const arr = [1, 2, 3, 4, 5];
for (let i = 0; i < arr.length; i++) {
  // Length is recalculated in each iteration
  console.log(arr[i]);
}</code></pre>
            </div>
            <div class="comparison-column">
                <h4>Efficient</h4>
                <pre><code>const arr = [1, 2, 3, 4, 5];
const len = arr.length; // Cached length
for (let i = 0; i < len; i++) {
  console.log(arr[i]);
}</code></pre>
            </div>
        </div>
        
        <h3>3. Reducing DOM Manipulation</h3>
        <p>DOM operations are expensive. Minimize them and batch changes when possible.</p>
        
        <div class="comparison">
            <div class="comparison-column">
                <h4>Inefficient</h4>
                <pre><code>// Multiple DOM operations
for (let i = 0; i < 100; i++) {
  const div = document.createElement('div');
  div.textContent = `Item ${i}`;
  document.body.appendChild(div);
}</code></pre>
            </div>
            <div class="comparison-column">
                <h4>Efficient</h4>
                <pre><code>// Batch DOM operations
const fragment = document.createDocumentFragment();
for (let i = 0; i < 100; i++) {
  const div = document.createElement('div');
  div.textContent = `Item ${i}`;
  fragment.appendChild(div);
}
document.body.appendChild(fragment);</code></pre>
            </div>
        </div>
        
        <h3>4. Memoization</h3>
        <p>Cache the results of expensive function calls to avoid redundant calculations.</p>
        
        <pre><code>// Memoization example
function memoize(fn) {
  const cache = new Map();
  return function(...args) {
    const key = JSON.stringify(args);
    if (cache.has(key)) {
      return cache.get(key);
    }
    const result = fn.apply(this, args);
    cache.set(key, result);
    return result;
  };
}

// Example: Fibonacci with memoization
const fibonacci = memoize(function(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
});</code></pre>
        
        <h3>5. Debouncing and Throttling</h3>
        <p>Limit the rate at which functions are called, especially for event handlers.</p>
        
        <pre><code>// Debounce: Execute function only after a specified delay
function debounce(func, delay) {
  let timeout;
  return function(...args) {
    clearTimeout(timeout);
    timeout = setTimeout(() => func.apply(this, args), delay);
  };
}

// Throttle: Execute function at most once per specified interval
function throttle(func, limit) {
  let inThrottle;
  return function(...args) {
    if (!inThrottle) {
      func.apply(this, args);
      inThrottle = true;
      setTimeout(() => inThrottle = false, limit);
    }
  };
}

// Usage
const debouncedSearch = debounce(searchFunction, 300);
const throttledScroll = throttle(scrollHandler, 100);

window.addEventListener('scroll', throttledScroll);
searchInput.addEventListener('input', debouncedSearch);</code></pre>
        
        <h3>6. Web Workers</h3>
        <p>Offload heavy computations to background threads to keep the main thread responsive.</p>
        
        <pre><code>// main.js
const worker = new Worker('worker.js');

worker.addEventListener('message', event => {
  console.log('Result from worker:', event.data);
});

worker.postMessage({
  data: largeArray,
  operation: 'process'
});

// worker.js
self.addEventListener('message', event => {
  const { data, operation } = event.data;
  
  if (operation === 'process') {
    // Perform expensive computation
    const result = processData(data);
    self.postMessage(result);
  }
});</code></pre>
        
        <div class="performance-tip">
            <h4>Performance Tip: Use requestAnimationFrame</h4>
            <p>For animations and visual updates, use <code>requestAnimationFrame</code> instead of <code>setTimeout</code> or <code>setInterval</code> to ensure smooth rendering and better battery life.</p>
            <pre><code>function animate() {
  // Update animation state
  updateAnimation();
  
  // Schedule the next frame
  requestAnimationFrame(animate);
}

// Start the animation
requestAnimationFrame(animate);</code></pre>
        </div>
        
        <h2>Loading and Execution Optimization</h2>
        
        <h3>1. Code Splitting</h3>
        <p>Split your JavaScript into smaller chunks that can be loaded on demand.</p>
        
        <pre><code>// Using dynamic imports (ES2020)
button.addEventListener('click', async () => {
  try {
    // Load the module only when needed
    const { default: Chart } = await import('./chart.js');
    const chart = new Chart(data);
    chart.render();
  } catch (error) {
    console.error('Failed to load chart module:', error);
  }
});</code></pre>
        
        <h3>2. Script Loading Strategies</h3>
        <ul>
            <li><code>async</code>: Load scripts asynchronously without blocking HTML parsing</li>
            <li><code>defer</code>: Load scripts after HTML parsing is complete but before DOMContentLoaded</li>
            <li>Dynamic script loading: Create script elements programmatically</li>
        </ul>
        
        <pre><code>&lt;!-- Async loading -->
&lt;script src="analytics.js" async>&lt;/script>

&lt;!-- Deferred loading -->
&lt;script src="app.js" defer>&lt;/script>

&lt;!-- Dynamic loading -->
&lt;script>
  function loadScript(src) {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = src;
      script.onload = () => resolve();
      script.onerror = () => reject(new Error(`Script load error: ${src}`));
      document.head.appendChild(script);
    });
  }
  
  // Load script when needed
  loadScript('heavy-library.js')
    .then(() => console.log('Script loaded'))
    .catch(error => console.error(error));
&lt;/script></code></pre>
        
        <h3>3. Tree Shaking</h3>
        <p>Eliminate dead code by using ES modules and a bundler that supports tree shaking (like Webpack or Rollup).</p>
        
        <div class="comparison">
            <div class="comparison-column">
                <h4>Without Tree Shaking</h4>
                <pre><code>// Import entire library
import * as utils from './utils';

// Only use one function
utils.formatDate(new Date());</code></pre>
            </div>
            <div class="comparison-column">
                <h4>With Tree Shaking</h4>
                <pre><code>// Import only what you need
import { formatDate } from './utils';

// Use the imported function
formatDate(new Date());</code></pre>
            </div>
        </div>
        
        <h2>Memory Management</h2>
        
        <h3>1. Avoiding Memory Leaks</h3>
        <p>Common causes of memory leaks in JavaScript:</p>
        <ul>
            <li>Forgotten event listeners</li>
            <li>Closures that reference large objects</li>
            <li>Circular references</li>
            <li>Global variables</li>
        </ul>
        
        <div class="comparison">
            <div class="comparison-column">
                <h4>Memory Leak</h4>
                <pre><code>function setupHandler() {
  const largeData = new Array(10000).fill('x');
  
  // Event listener keeps reference to largeData
  document.getElementById('button')
    .addEventListener('click', function() {
      console.log(largeData.length);
    });
}</code></pre>
            </div>
            <div class="comparison-column">
                <h4>Proper Cleanup</h4>
                <pre><code>function setupHandler() {
  const largeData = new Array(10000).fill('x');
  
  const handleClick = function() {
    console.log(largeData.length);
  };
  
  const button = document.getElementById('button');
  button.addEventListener('click', handleClick);
  
  // Return cleanup function
  return function cleanup() {
    button.removeEventListener('click', handleClick);
  };
}</code></pre>
            </div>
        </div>
        
        <h3>2. Object Pooling</h3>
        <p>Reuse objects instead of creating new ones to reduce garbage collection.</p>
        
        <pre><code>// Object pool example
class ObjectPool {
  constructor(createFn, maxSize = 10) {
    this.createFn = createFn;
    this.pool = [];
    this.maxSize = maxSize;
  }
  
  get() {
    if (this.pool.length > 0) {
      return this.pool.pop();
    }
    return this.createFn();
  }
  
  release(obj) {
    if (this.pool.length < this.maxSize) {
      this.pool.push(obj);
    }
  }
}

// Usage example for particle system
const particlePool = new ObjectPool(() => new Particle());

function createParticle(x, y) {
  const particle = particlePool.get();
  particle.reset(x, y);
  return particle;
}

function removeParticle(particle) {
  particlePool.release(particle);
}</code></pre>
        
        <div class="examples">
            <h3>Performance Measurement</h3>
            
            <h4>Using Performance API</h4>
            <pre><code>// Measure execution time
performance.mark('start');

// Code to measure
for (let i = 0; i < 1000000; i++) {
  // Some operation
}

performance.mark('end');
performance.measure('Operation', 'start', 'end');

const measurements = performance.getEntriesByType('measure');
console.log(`Operation took ${measurements[0].duration.toFixed(2)}ms`);

// Clear marks and measures
performance.clearMarks();
performance.clearMeasures();</code></pre>
            
            <h4>Comparing Approaches</h4>
            <pre><code>function benchmark(fn, iterations = 100) {
  const times = [];
  
  for (let i = 0; i < iterations; i++) {
    const start = performance.now();
    fn();
    const end = performance.now();
    times.push(end - start);
  }
  
  const average = times.reduce((sum, time) => sum + time, 0) / times.length;
  const min = Math.min(...times);
  const max = Math.max(...times);
  
  return { average, min, max };
}

// Compare two approaches
const approach1Result = benchmark(() => {
  // First approach
  const arr = [];
  for (let i = 0; i < 10000; i++) {
    arr.push(i);
  }
});

const approach2Result = benchmark(() => {
  // Second approach
  const arr = new Array(10000);
  for (let i = 0; i < 10000; i++) {
    arr[i] = i;
  }
});

console.log('Approach 1:', approach1Result);
console.log('Approach 2:', approach2Result);</code></pre>
        </div>
        
        <div class="resources">
            <h3>Additional Resources</h3>
            <ul>
                <li><a href="https://web.dev/fast/" target="_blank">web.dev: Fast load times</a></li>
                <li><a href="https://developers.google.com/web/fundamentals/performance/rendering" target="_blank">Google Developers: Rendering Performance</a></li>
                <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance" target="_blank">MDN: Performance API</a></li>
                <li><a href="https://github.com/GoogleChromeLabs/web-vitals" target="_blank">Web Vitals Library</a></li>
                <li><a href="https://v8.dev/blog" target="_blank">V8 Blog (JavaScript Engine)</a></li>
                <li><a href="https://addyosmani.com/blog/performance-budgets/" target="_blank">Addy Osmani: Performance Budgets</a></li>
                <li><a href="https://developer.chrome.com/docs/devtools/evaluate-performance/" target="_blank">Chrome DevTools: Analyze Runtime Performance</a></li>
            </ul>
        </div>
    </div>

    <script>
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
        }
    </script>
</body>
</html>